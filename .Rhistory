svi17_esl %>%
select(GEOID, all_of(m_vars)) %>%
pivot_longer(all_of(m_vars), values_to="moe") %>%
mutate(name=str_sub(name, 1, end=-2L)),
by=c("GEOID", "name")
) %>%
group_by(GEOID) %>%
summarize(comb.e=sum(estimate),
comb.moe=sqrt(sum(is_est_zero*moe^2))),
by=c("GEOID")
) %>%
mutate(per.e = Perc(comb.e,summary_est),
per.moe = per_moe(comb.moe,summary_moe,comb.e,summary_est))
sum_col <- function(...){
# x <- list(...) # THIS WILL BE A LIST STORING EVERYTHING:
rowSums(across(all_of(...)), na.rm = TRUE)       # Example of inbuilt function
}
sum_moe <- function(...){
sqrt(rowSums((across(all_of(...)))^2, na.rm = TRUE) )
}
Perc <- function(sum,total){
100 * sum /total
}
per_moe <- function(sum_moe,total_moe,sum,total){
100*sqrt(sum_moe^2-total_moe^2*(sum /total)^2)/total
}
svi17_esl %>% arrange(GEOID) %>%
left_join(
svi17_esl %>%
select(GEOID, all_of(e_vars)) %>%
pivot_longer(all_of(e_vars), values_to="estimate") %>%
mutate(name=str_sub(name, 1, end=-2L),
is_est_zero=if_else(estimate==0, 0L, 1L)) %>%
left_join(
svi17_esl %>%
select(GEOID, all_of(m_vars)) %>%
pivot_longer(all_of(m_vars), values_to="moe") %>%
mutate(name=str_sub(name, 1, end=-2L)),
by=c("GEOID", "name")
) %>%
group_by(GEOID) %>%
summarize(comb.e=sum(estimate),
comb.moe=sqrt(sum(is_est_zero*moe^2))),
by=c("GEOID")
) %>%
mutate(per.e = Perc(comb.e,summary_est),
per.moe = per_moe(comb.moe,summary_moe,comb.e,summary_est))
comb <- function(var_list,summary_list){
var_e <- paste0(var_list,"E")
var_m <- paste0(var_list,"M")
# e_vars <- names(data) %>%  str_subset(pattern = "^B.*") %>%  str_subset(pattern = ".*E$")
# m_vars <- names(data) %>%  str_subset(pattern = "^B.*") %>%  str_subset(pattern = ".*M$")
data <- get_acs(
state = "41",
county = c('051','067','005'), # tri_cou,
geography = "block group",
variables = var_list, output = "wide",
summary_var = summary_list, cache_table = T
) %>% arrange(GEOID)
data %>%
left_join(
data %>%
select(GEOID, all_of(var_e)) %>%
pivot_longer(all_of(var_e), values_to="estimate") %>%
mutate(name=str_sub(name, 1, end=-2L),
is_est_zero=if_else(estimate==0, 0L, 1L)) %>%
left_join(
data %>%
select(GEOID, all_of(var_m)) %>%
pivot_longer(all_of(var_m), values_to="moe") %>%
mutate(name=str_sub(name, 1, end=-2L)),
by=c("GEOID", "name")
) %>%
group_by(GEOID) %>%
summarize(comb.e=sum(estimate),
comb.moe=sqrt(sum(is_est_zero*moe^2))),
by=c("GEOID")
) %>%
mutate(per.e = Perc(comb.e,summary_est),
per.moe = per_moe(comb.moe,summary_moe,comb.e,summary_est))
}
SVI[[17]] <- svi17_esl <- comb(esl_var,esl_tot)
esl_var <- (vars %>% filter(grepl("B16004_",name),grepl("Speak English \"not well\"|Speak English \"not at all\"",label)))$name
p_load(tidyverse, tidycensus, tigris, kableExtra )
SVI[[17]] <- svi17_esl <- comb(esl_var,esl_tot)
esl_var <- (vars %>% filter(grepl("B16004_",name),grepl("Speak English \"not well\"|Speak English \"not at all\"",label)))$name
vars <- load_variables(2019, "acs5")
# tri_cou <- c(Multnomah = "41051", Washington = "41067", Clackamas = "41005") #, Yamhill = "41071" , Clark = "53011"
tri_cou <- c('051','067','005')# "Multnomah", "Washington", "Clackamas"
esl_var <- (vars %>% filter(grepl("B16004_",name),grepl("Speak English \"not well\"|Speak English \"not at all\"",label)))$name
esl_tot <- c("B16004_001")
SVI[[17]] <- svi17_esl <- comb(esl_var,esl_tot)
SVI[[17]]
svi17_esl
svi17_esl <- readRDS("SVI.RDS")[[17]]
svi17_esl
saveRDS(SVI,file = "SVI.RDS")
SVI[[17]]
svi17_esl %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
svi17_esl <- readRDS("SVI.RDS")[[17]]
svi17_esl %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
knitr::opts_chunk$set(echo = TRUE,message=F,warning = F,cache = F)
if (!require(pacman)) {install.packages("pacman"); library(pacman)}
p_load(tidyverse, tidycensus, tigris, mapview, leafsync, kableExtra )
# crsuggest,
# remotes::install_github("walkerke/crsuggest")
# remotes::install_github("walkerke/tidycensus")
# devtools::install_github('walkerke/tigris')
options(tigris_use_cache = TRUE)
rappdirs::user_cache_dir('tigris')
sum_col <- function(...){
# x <- list(...) # THIS WILL BE A LIST STORING EVERYTHING:
rowSums(across(all_of(...)), na.rm = TRUE)       # Example of inbuilt function
}
sum_moe <- function(...){
sqrt(rowSums((across(all_of(...)))^2, na.rm = TRUE) )
}
Perc <- function(sum,total){
100 * sum /total
}
per_moe <- function(sum_moe,total_moe,sum,total){
100*sqrt(sum_moe^2-total_moe^2*(sum /total)^2)/total
}
comb <- function(var_list,summary_list){
var_e <- paste0(var_list,"E")
var_m <- paste0(var_list,"M")
data <- get_acs(
state = "41",
county = c('051','067','005'), # tri_cou,
geography = "block group",
variables = var_list, output = "wide",
summary_var = summary_list, cache_table = T
) %>% arrange(GEOID)
data %>%
left_join(
data %>%
select(GEOID, all_of(var_e)) %>%
pivot_longer(all_of(var_e), values_to="estimate") %>%
mutate(name=str_sub(name, 1, end=-2L),
is_est_zero=if_else(estimate==0, 0L, 1L)) %>%
left_join(
data %>%
select(GEOID, all_of(var_m)) %>%
pivot_longer(all_of(var_m), values_to="moe") %>%
mutate(name=str_sub(name, 1, end=-2L)),
by=c("GEOID", "name")
) %>%
group_by(GEOID) %>%
summarize(comb.e=sum(estimate),
comb.moe=sqrt(sum(is_est_zero*moe^2))),
by=c("GEOID")
) %>%
mutate(per.e = Perc(comb.e,summary_est),
per.moe = per_moe(comb.moe,summary_moe,comb.e,summary_est))
}
noveh_var <- c("B25044_003","B25044_010")
noveh_tot <- c("B25044_001")
noveh <- comb(noveh_var,noveh_tot)
readRDS("noveh.RDS")
noveh
saveRDS(noveh,file = "noveh.RDS")
noveh <- readRDS("noveh.RDS")
noveh %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(20)
noveh.sig <- noveh %>% filter(per.e>per.moe)
noveh.sig %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(20)
noveh
noveh %>% filter(per.e>per.moe)
nrow(pdx_bg_noveh.sig)
pdx_bg_noveh.sig <- pdx_bg %>% inner_join(noveh.sig,by="GEOID")
pdx_bg <- readRDS("pdx_bg.RDS")
pdx_bg_noveh.sig <- pdx_bg %>% inner_join(noveh.sig,by="GEOID")
nrow(pdx_bg_noveh.sig)
child_var <- c("B09002_008")
child_tot <- c("B09002_001")
SVI <- lst()
SVI[[1]] <- svi1_child <- comb(child_var,child_tot)
svi1_child %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
svi1_child <- readRDS("SVI.RDS")[[1]]
l5_var <- c("B01001_003", "B01001_027")
l5_tot <- c("B01001_001")
SVI[[2]] <- svi2_l5 <- comb(l5_var,l5_tot)
saveRDS(SVI,file = "SVI.RDS")
svi2_l5 <- readRDS("SVI.RDS")[[2]]
svi2_l5 %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
g65_var <- c("C21007_017")
g65_tot <- c("B01003_001")
SVI[[3]] <- svi3_g65 <- comb(g65_var,g65_tot)
saveRDS(SVI,file = "SVI.RDS")
svi3_g65 %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
g65_pov_var <- c("C21007_019","C21007_026")
g65_pov_tot <- c("C21007_017")
SVI[[4]] <- svi4_g65_pov <- comb(g65_pov_var,g65_pov_tot)
saveRDS(SVI,file = "SVI.RDS")
svi4_g65_pov %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
g16_tran_var <- c("B08301_010")
g16_tran_tot <- c("B23025_004")
SVI[[5]] <- svi5_g16_tran <- comb(g16_tran_var,g16_tran_tot)
saveRDS(SVI,file = "SVI.RDS")
svi5_g16_tran %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
noveh_var <- c("B25044_003","B25044_010")
noveh_tot <- c("B25044_001")
SVI[[6]] <- svi6_noveh <- comb(noveh_var,noveh_tot)
saveRDS(SVI,file = "SVI.RDS")
svi6_noveh %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
vac_var <- c("B25002_003")
vac_tot <- c("B25002_001")
SVI[[7]] <- svi7_vac <- comb(vac_var,vac_tot)
saveRDS(SVI,file = "SVI.RDS")
svi7_vac %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
svi6_noveh %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
rent_var <- c("B25003_003")
rent_tot <- c("B25003_001")
SVI[[8]] <- svi8_rent <- comb(rent_var,rent_tot)
saveRDS(SVI,file = "SVI.RDS")
svi8_vac %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
svi8_rent %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
white_tot <- c("B02001_001")
nonwhite_var <- paste0("B02001_00",3:8)
SVI[[9]] <- svi9_nonwhite <- comb(nonwhite_var,white_tot)
saveRDS(SVI,file = "SVI.RDS")
svi9_nonwhite %>% select(summary_est, summary_moe,sum,sumMOE,per,perMOE) %>%
head(10)
svi9_nonwhite %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
c(paste0("B25034_00",5:9),"B25034_010","B25034_011")
oldhou_var <- c(paste0("B25034_00",5:9),"B25034_010","B25034_011")
oldhou_var
vars %>% filter(name %in% c(newhou_tot,oldhou_var))
# newhou_var <- c("B25034_002","B25034_003","B25034_004")
newhou_tot <- c("B25034_001")
vars %>% filter(name %in% c(newhou_tot,oldhou_var))
SVI[[11]] <- svi11_oldhou <- comb(oldhou_var,newhou_tot)
saveRDS(SVI,file = "SVI.RDS")
svi11_oldhou %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
mhou_var <- c("B25024_010")
mhou_tot <- c("B25024_001")
SVI[[12]] <- svi12_mhou <- comb(mhou_var,mhou_tot)
saveRDS(SVI,file = "SVI.RDS")
svi12_mhou %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
pov_var <- c("C17002_002","C17002_003")
pov_tot <- c("C17002_001")
SVI[[13]] <- svi13_pov <- comb(pov_var,pov_tot)
saveRDS(SVI,file = "SVI.RDS")
svi13_pov %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
nophone_var <- c("B25043_007","B25043_016")
nophone_tot <- c("B25043_001")
SVI[[14]] <- svi14_pov <- comb(nophone_var,nophone_tot)
saveRDS(SVI,file = "SVI.RDS")
svi14_nophone %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
svi14_nophone <- readRDS("SVI.RDS")[[14]]
svi14_nophone %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
noedu_var <- c(paste0("B15003_00",2:9),paste0("B15003_01",0:6))
noedu_tot <- c("B15003_001")
SVI[[15]] <- svi15_noedu <- comb(noedu_var,noedu_tot)
saveRDS(SVI,file = "SVI.RDS")
svi15_noedu <- readRDS("SVI.RDS")[[15]]
svi15_noedu %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
unemp_var <- c("B23025_005")
unemp_tot <- c("B23025_002")
SVI[[16]] <- svi16_unemp <- comb(unemp_var,unemp_tot)
saveRDS(SVI,file = "SVI.RDS")
svi16_unemp %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
esl_var <- (vars %>% filter(grepl("B16004_",name),grepl("Speak English \"not well\"|Speak English \"not at all\"",label)))$name
esl_tot <- c("B16004_001")
SVI[[17]] <- svi17_esl <- comb(esl_var,esl_tot)
saveRDS(SVI,file = "SVI.RDS")
svi17_esl %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
dis_var <- c("B23024_003","B23024_018")
dis_tot <- c("B23024_001")
SVI[[18]] <- svi18_dis <- comb(dis_var,dis_tot)
saveRDS(SVI,file = "SVI.RDS")
svi18_dis %>% select(summary_est, summary_moe, comb.e,comb.moe,per.e,per.moe) %>%
head(10)
blogdown:::preview_site()
gc()
blogdown::stop_server()
gc()
blogdown::serve_site()
blogdown::stop_server()
gc()
# mapview, crsuggest,
install.packages("osmdata")
# mapview, crsuggest,
remotes::install_github('ropensci/osmdata')
# pdx_bg <- block_groups(state = "41",county = tri_cou, cb = FALSE, year = 2019)
# pdx_bg <- pdx_bg %>% filter(str_sub(GEOID10, 1, 5)  %in% tri_cou)
pdx_bg <- readRDS("pdx_bg.RDS")
pdx_bg
available_features ()
p_load(tidyverse, osmdata )
knitr::opts_chunk$set(echo = TRUE,message=F,warning = F,cache = T)
if (!require(pacman)) {install.packages("pacman"); library(pacman)}
p_load(tidyverse, osmdata )
# mapview, crsuggest,
# remotes::install_github('ropensci/osmdata')
available_features ()
pdx_osm <- opq(bbox = 'portland or us') %>%
add_osm_feature(key = 'highway', value = 'motorway')
pdx_osm
pdx_bg
pdx_osm$features
pdx_osm$suffix
pdx_osm <- opq(bbox = 'portland or us') %>%
add_osm_feature(key = 'highway', value = 'motorway') %>%
osmdata_sf ()
pdx_osm
knitr::opts_chunk$set(echo = TRUE,message=F,warning = F,cache = T)
if (!require(pacman)) {install.packages("pacman"); library(pacman)}
p_load(tidyverse,mapview, osmdata )
# mapview, crsuggest,
# remotes::install_github('ropensci/osmdata')
mapview(pdx_osm)
```{r,echo=F
pdx_osm <- opq(bbox = getbb('Portland, OR, U.S.'))
identical(pdx_osm, opq(bbox = 'portland or us'))
```
# Base Social Vulnerability Indicators(percentages)
```{r, eval=T}
```{r, eval=T}
```{r,echo=F
pdx_osm <- opq(bbox = getbb('Portland OR, U.S.'))
identical(pdx_osm, opq(bbox = 'portland or us'))
```
pdx_osm <- opq(bbox = getbb('Portland OR, U.S.'))
identical(pdx_osm, opq(bbox = 'portland or us'))
pdx_osm <- opq(bbox = getbb('Portland, OR, U.S.'))
identical(pdx_osm, opq(bbox = 'portland or us'))
pdx_osm
opq(bbox = 'portland or us')
getbb('Portland, OR, U.S.')
?getbb
getbb("Portland", format_out = "data.frame", limit = 3)
getbb("Portland", format_out = "data.frame", limit = 20)
# getbb("Portland", format_out = "data.frame", limit = 20)
getbb("Portland", display_name_contains ="Portland, Multnomah County, Oregon, United States")
pdx_osm <- opq(bbox = getbb("Portland", display_name_contains ="Portland, Multnomah County, Oregon, United States"))
identical(pdx_osm, opq(bbox = 'portland or us'))
pdx_osm
identical(opq(bbox = getbb("Portland", display_name_contains ="Portland, Multnomah County, Oregon, United States")),
opq(bbox = 'portland or us'))
getbb("Portland", display_name_contains ="Portland, Multnomah County, Oregon, United States")
opq(bbox = getbb("Portland", display_name_contains ="Portland, Multnomah County, Oregon, United States")
)
getbb("Portland", format_out = "data.frame", limit = 20)
getbb(osm_id = 186579, format_out = "data.frame")
getbb(osm_id = "186579", format_out = "data.frame")
getbb("Portland", format_out = "data.frame", limit = 20)
getbb(place_id = "258407990", format_out = "data.frame")
getbb(place_name = "portand or", format_out = "data.frame")
getbb(place_name = "portand or us", format_out = "data.frame")
getbb(place_name = "portand", format_out = "data.frame")
getbb(place_name = "portland", format_out = "data.frame")
getbb(place_name = "portland or", format_out = "data.frame")
getbb(place_name = "portland or", format_out = "polygon")
pdx_df <- getbb(place_name = "portland or", format_out = "data.frame")
pdx_poly <- getbb(place_name = "portland or", format_out = "polygon")
pdx_osm <- opq(bbox = pdx_poly) %>%
add_osm_feature(key = 'highway', value = 'motorway') %>%
osmdata_sf () %>%
trim_osmdata (pdx_poly)
pdx_poly
mapview(pdx_poly)
pdx_osm
getbb(place_name = c("Multnomah", "Washington", "Clackamas"), format_out = "data.frame")
getbb(place_name = "Multnomah", format_out = "data.frame")
get_overpass_url()
pdx_osm <- opq(bbox = pdx_poly) %>%
add_osm_feature(key = 'highway', value = 'motorway') %>%
osmdata_sf () %>%
trim_osmdata (pdx_poly)
opq_string(pdx_osm)
pdx_osm <- opq(bbox = 'portland or') %>%
add_osm_feature(key = 'highway', value = 'motorway')
opq_string(pdx_osm)
opq(bbox = 'Kunming, China') %>%
add_osm_feature(key = 'natural', value = 'water') %>%
osmdata_sf ()
dat1 <- opq(bbox = 'Kunming, China') %>%
add_osm_feature(key = 'natural', value = 'water') %>%
osmdata_sf ()
dat2 <- opq(bbox = 'Kunming, China') %>%
add_osm_feature(key = 'name:en', value = 'Dian', value_exact = FALSE) %>%
osmdata_sf ()
pdx_osm
pdx_osm <- opq(bbox = 'portland or') %>%
add_osm_feature(key = 'highway', value = 'motorway')
pdx_osm
pdx_osm <- opq(bbox = pdx_poly) %>%
add_osm_feature(key = 'highway', value = 'motorway') %>%
osmdata_sf () %>%
trim_osmdata (pdx_poly)
pdx_osm
opq_string(pdx_osm)
dat <- c (dat1, dat2)
dat
dat2
dat
mapview(dat)
osmdata_sf(opq_string(opq_string(pdx_osm)))
osmdata_sf(opq_string(pdx_osm))
pdx_osm <- opq('portland or') %>%
add_osm_feature(key = 'highway', value = 'cycleway')
osmdata_sp(pdx_osm)
pdx_osm.sp <- osmdata_sp(pdx_osm)
pdx_osm.sp
sp::plot(pdx_osm$osm_lines)
pdx_osm
pdx_osm.sp <- osmdata_sp(pdx_osm)
pdx_osm.sp
sp::plot(pdx_osm$osm_lines)
pdx_osm <- opq('portland or') %>%
add_osm_feature(key = 'highway', value = 'motorway')
pdx_osm.sp <- osmdata_sp(pdx_osm)
sp::plot(pdx_osm$osm_lines)
sp::plot(pdx_osm.sp$osm_lines)
mapview(pdx_osm.sp)
mapview(pdx_osm.sp)
pdx_osm.sf <- osmdata_sf(pdx_osm)
pdx_osm <- opq('portland or') %>%
add_osm_feature(key = 'highway', value = 'motorway') %>%
osmdata_xml(file = 'pdx.osm')
q <- opq('portland or') %>%
add_osm_feature(key = 'highway')
doc <- osmdata_xml(q, 'pdx.osm')
dat1 <- osmdata_sf(q, doc)
dat2 <- osmdata_sf(q, 'pdx.osm')
gc()
gc()
knitr::opts_chunk$set(echo = TRUE,message=F,warning = F,cache = T)
if (!require(pacman)) {install.packages("pacman"); library(pacman)}
p_load(tidyverse,mapview, osmdata )
# mapview, crsuggest,
# remotes::install_github('ropensci/osmdata')
pdx_osm <- opq('portland or') %>%
add_osm_feature(key = 'highway', value = 'motorway') %>%
osmdata_xml(file = 'pdx.osm')
q <- opq('portland or') %>%
add_osm_feature(key = 'highway', value = 'motorway')
doc <- osmdata_xml(q, 'pdx.osm')
dat1 <- osmdata_sf(q, doc)
dat2 <- osmdata_sf(q, 'pdx.osm')
identical(dat1, dat2)
readLines('pdx.osm')[1:6]
sf::st_read('pdx.osm', layer = 'points')
osmdata_sf(q, 'pdx.osm')
sf::st_read('pdx.osm', layer = 'multipolygons', quiet = TRUE)
sf::st_read('pdx.osm', layer = 'aeroway', quiet = TRUE)
sf::st_read('pdx.osm', layer = 'multipolygons', quiet = TRUE)
sf::st_read('pdx.osm', layer = 'osm_lines', quiet = TRUE)
dat <- sf::st_read('pdx.osm', layer = 'multipolygons', quiet = TRUE)
as(dat, 'Spatial')
sf::st_read('pdx.osm', layer = 'lines', quiet = TRUE)
dat <- sf::st_read('pdx.osm', layer = 'lines', quiet = TRUE)
dat_sp <- as(dat, 'Spatial')
class(dat_sp)
dim(dat_sp)
sp::plot(dat_sp$osm_lines)
sp::plot(dat$osm_lines)
pdx_sp <- opq ('portland ork') %>%
add_osm_feature (key = 'highway', value = 'motorway',
value_exact = FALSE) %>%
osmdata_sp()
pdx_sp <- opq ('portland or') %>%
add_osm_feature (key = 'highway', value = 'motorway',
value_exact = FALSE) %>%
osmdata_sp()
sp::plot(pdx_sp$osm_lines)
mapview(pdx_osm.sp)
mapview(pdx.sp)
?mapview
mapview(dat)
dat
dat %>% filter(`feature ID`==6)
class(dat)
mapview(dat)
dat %>% filter(`osm_id`==5509189)
dat_break <- dat %>% filter(`osm_id`!=5509189)
mapview(dat) + mapview(dat_break)
gc()
library(tidyverse)
library(mapview)
library(osmdata)
pdx_osm <- opq('portland or') %>%
add_osm_feature(key = 'highway', value = 'motorway') %>%
osmdata_xml(file = 'pdx.osm')
pdx_highway <- sf::st_read('pdx.osm', layer = 'lines', quiet = F)
pdx_highway_break <-pdx_highway %>% filter(osm_id!=5509189)
mapview(pdx_highway) + mapview(pdx_highway_break)
source("~/urbanstudy/NITC-Resilience/content/osm/breakaleg.R")
mapview(pdx_highway) + mapview(pdx_highway_break)
